<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ResearchMate</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body class="booting">
    <!-- AUTH (shown first) -->
    <div id="boot-splash">
      <div class="boot-card">
        <span class="dot"></span>
        <div>ResearchMate</div>
      </div>
    </div>

    <div id="auth">
      <div class="card auth-card">
        <h2>Welcome to ResearchMate</h2>
        <p class="sub">Sign in to sync your highlights across devices.</p>

        <div class="form">
          <input
            id="email"
            type="email"
            placeholder="Email"
            autocomplete="username"
          />
          <input
            id="password"
            type="password"
            placeholder="Password (min 6 chars)"
            autocomplete="new-password"
          />
        </div>

        <div class="auth-actions">
          <button id="signup" class="secondary-btn" type="button">
            Sign up
          </button>
          <button id="signin" class="primary-btn" type="button">Sign in</button>
          <!-- (optional) Google button stays here too -->
        </div>

        <pre id="auth-log" class="log"></pre>
      </div>
    </div>

    <!-- APP (after login) -->
    <div id="app" class="container hidden">
      <header>
        <h1>
          <!-- book-open icon -->
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path
              d="M21 4H12a4 4 0 0 0-4 4v10a3 3 0 0 1 3-3h10V4zM3 6a2 2 0 0 1 2-2h7v13H8a3 3 0 0 0-3 3V6z"
              fill="currentColor"
            />
          </svg>
          ResearchMate
        </h1>

        <div class="tabs">
          <button class="tab-btn active" data-tab="collect" title="Highlight">
            <!-- highlighter icon -->
            <svg viewBox="0 0 24 24" width="16" height="16">
              <path
                d="M3 16l5 5 3-3-5-5-3 3zm6-6l5 5 6-6-5-5-6 6z"
                fill="currentColor"
              />
            </svg>
          </button>
          <button class="tab-btn" data-tab="saved" title="Saved">
            <!-- bookmark icon -->
            <svg viewBox="0 0 24 24" width="16" height="16">
              <path d="M6 2h12v20l-6-4-6 4V2z" fill="currentColor" />
            </svg>
          </button>
          <button class="tab-btn" data-tab="summary" title="AI">
            <!-- robot icon -->
            <svg viewBox="0 0 24 24" width="16" height="16">
              <path
                d="M9 2h6v2h3a2 2 0 012 2v8a4 4 0 01-4 4h-8a4 4 0 01-4-4V6a2 2 0 012-2h3V2h2zM7 10h2v2H7v-2zm8 0h2v2h-2v-2z"
                fill="currentColor"
              />
            </svg>
          </button>
          <button class="tab-btn" data-tab="settings" title="Settings">
            <!-- gear icon -->
            <svg viewBox="0 0 24 24" width="16" height="16">
              <path
                d="M12 8a4 4 0 100 8 4 4 0 000-8zm9 4a7.9 7.9 0 00-.2-1.8l2.1-1.6-2-3.5-2.6 1a8 8 0 00-3.1-1.8L14.8 2h-5.6l-.4 3.3A8 8 0 005.7 7l-2.6-1-2 3.5 2.1 1.6A8 8 0 003 12c0 .6.1 1.2.2 1.8L1.1 15.4l2 3.5 2.6-1a8 8 0 003.1 1.8l.4 3.3h5.6l.4-3.3a8 8 0 003.1-1.8l2.6 1 2-3.5-2.1-1.6c.1-.6.2-1.2.2-1.8z"
                fill="currentColor"
              />
            </svg>
          </button>
        </div>
      </header>

      <!-- Collect -->
      <div class="tab-content active" id="collect-tab">
        <h3>Current Selection</h3>
        <div id="selected-text" class="selection-preview"></div>
        <div class="form-group">
          <label class="lbl">Tags (comma separated):</label>
          <input
            type="text"
            id="tags-input"
            placeholder="biology, climate, research"
          />
        </div>

        <div class="form-group">
          <label class="lbl">Notes:</label>
          <textarea
            id="notes-input"
            rows="2"
            placeholder="Optional notes..."
          ></textarea>
        </div>

        <div class="row">
          <button id="save-btn" class="primary-btn" type="button">
            <svg viewBox="0 0 24 24" width="16" height="16">
              <path d="M5 20h14v-9H5v9zm14-11V4H5v5h14z" fill="currentColor" />
            </svg>
            Save Selection
          </button>

          <!-- small meta on the right (domain/title); keep this, itâ€™s not a label -->
          <span
            id="captured-meta"
            class="muted small"
            style="margin-left: auto"
          ></span>
        </div>
      </div>

      <!-- Saved -->
      <div class="tab-content" id="saved-tab">
        <div class="search-box">
          <input
            id="search-input"
            type="text"
            placeholder="Search saved items..."
          />
          <svg viewBox="0 0 24 24" width="16" height="16">
            <path
              d="M15.5 14h-.8l-.3-.3A6.5 6.5 0 1015.5 14l4.5 4.5-1.5 1.5L15.5 14zM10 15a5 5 0 110-10 5 5 0 010 10z"
              fill="currentColor"
            />
          </svg>
        </div>
        <div id="saved-items-list" class="saved-items">
          <div class="empty-state" id="empty-state">
            <svg viewBox="0 0 24 24" width="20" height="20">
              <path d="M6 2h12v20l-6-4-6 4V2z" fill="currentColor" />
            </svg>
            <p>No saved items yet</p>
          </div>
        </div>
      </div>

      <!-- AI -->
      <div class="tab-content" id="summary-tab">
        <!-- API key row ONLY lives in this tab -->
        <div class="row" style="gap: 8px; margin-bottom: 8px">
          <input id="aiKey" type="password" style="flex: 1" />
          <button id="saveAIKey" class="secondary-btn" type="button">
            Save Key
          </button>
        </div>

        <textarea
          id="summary-input"
          placeholder="Paste text to summarize..."
        ></textarea>

        <div class="row center" style="margin-top: 8px">
          <button id="summarize-btn" class="primary-btn" type="button">
            Generate Summary
          </button>
        </div>

        <div id="summary-result" class="hidden">
          <h3>AI Summary</h3>
          <div class="summary-content"></div>
        </div>
      </div>

      <!-- Settings -->
      <div class="tab-content" id="settings-tab">
        <div class="row center" style="margin-bottom: 8px">
          <button id="shuffleTheme" class="secondary-btn" type="button">
            Shuffle Theme
          </button>
        </div>
        <div class="row">
          <label><input type="checkbox" id="darkMode" /> Dark mode</label>
        </div>
        <div class="row">
          <label
            >Font
            <select id="fontFamily">
              <option value="system-ui">System</option>
              <option value="serif">Serif</option>
              <option value="monospace">Monospace</option>
            </select>
          </label>
          <label style="margin-left: auto"
            >Size
            <input id="fontSize" type="range" min="12" max="18" value="14" />
          </label>
        </div>
        <div class="row right">
          <button id="signout" class="danger-btn" type="button">Logout</button>
        </div>
      </div>
    </div>

    <script type="module" src="popup.js"></script>
    <div id="toast" class="toast" role="status" aria-live="polite"></div>
  </body>
</html>
